var S=class{constructor(t){this.triggersList=null;this.editFormContainer=null;this.addTriggerBtn=null;this.app=t,this.initializeUIElements(),this.initializeEventListeners()}initializeUIElements(){this.triggersList=document.getElementById("triggers-list"),this.editFormContainer=document.getElementById("trigger-edit-form-container"),this.addTriggerBtn=document.getElementById("add-trigger")}initializeEventListeners(){this.addTriggerBtn&&this.addTriggerBtn.addEventListener("click",()=>{this.showEditForm(null,-1)})}loadTriggers(){!this.triggersList||!this.app.settings.Triggers||(this.triggersList.innerHTML="",this.editFormContainer&&(this.editFormContainer.innerHTML="",this.editFormContainer.classList.remove("active")),this.app.settings.Triggers.forEach((t,C)=>{if(this.triggersList===null)return;let r=document.createElement("tr");r.dataset.index=C.toString();let c=document.createElement("td");c.textContent=t.match,r.appendChild(c);let E=document.createElement("td");E.textContent=t.type||"regex",r.appendChild(E);let s=document.createElement("td");s.textContent=t.actionType||"text",r.appendChild(s);let l=document.createElement("td");l.textContent=t.actions,r.appendChild(l);let d=document.createElement("td"),a=document.createElement("button");a.className="client-button",a.textContent="Edit",a.style.marginRight="5px",a.addEventListener("click",()=>{this.showEditForm(t,C)});let g=document.createElement("button");g.className="client-button",g.textContent="Delete",g.addEventListener("click",()=>{this.app.settings.Triggers.splice(C,1),this.app.saveSettings(),this.loadTriggers()}),d.appendChild(a),d.appendChild(g),r.appendChild(d),this.triggersList.appendChild(r)}))}showEditForm(t,C){if(!this.editFormContainer)return;this.editFormContainer.innerHTML="";let r=document.createElement("h4");r.textContent=C===-1?"Add New Trigger":"Edit Trigger",this.editFormContainer.appendChild(r);let c=document.createElement("div");c.className="form-row";let E=document.createElement("label");E.textContent="Pattern:",E.setAttribute("for","edit-trigger-pattern");let s=document.createElement("input");s.type="text",s.id="edit-trigger-pattern",s.value=t?t.match:"",s.placeholder="e.g., ^You are hungry\\.$",c.appendChild(E),c.appendChild(s),this.editFormContainer.appendChild(c);let l=document.createElement("div");l.className="form-row";let d=document.createElement("label");d.textContent="Match Type:",d.setAttribute("for","edit-trigger-type");let a=document.createElement("select");a.id="edit-trigger-type",["regex","substring","exact"].forEach(e=>{let n=document.createElement("option");n.value=e,n.textContent=e.charAt(0).toUpperCase()+e.slice(1),(t&&t.type===e||!t&&e==="regex")&&(n.selected=!0),a.appendChild(n)}),l.appendChild(d),l.appendChild(a),this.editFormContainer.appendChild(l);let x=document.createElement("div");x.className="form-row";let F=document.createElement("label");F.textContent="Action Type:",F.setAttribute("for","edit-trigger-action-type");let p=document.createElement("select");p.id="edit-trigger-action-type",["text","javascript"].forEach(e=>{let n=document.createElement("option");n.value=e,n.textContent=e.charAt(0).toUpperCase()+e.slice(1),(t&&t.actionType===e||!t&&e==="text")&&(n.selected=!0),p.appendChild(n)}),x.appendChild(F),x.appendChild(p),this.editFormContainer.appendChild(x);let y=document.createElement("div");y.className="form-row";let N=document.createElement("label");N.textContent="Actions:",N.setAttribute("for","edit-trigger-actions");let o=document.createElement("textarea");o.id="edit-trigger-actions",o.value=t?t.actions:"",o.placeholder="Enter commands or JavaScript code",p.addEventListener("change",()=>{p.value==="text"?o.placeholder="Enter commands to execute when triggered":o.placeholder="Enter JavaScript code to execute when triggered"}),y.appendChild(N),y.appendChild(o),this.editFormContainer.appendChild(y);let f=document.createElement("div");f.innerHTML="<small>Tip: Triggers automatically execute actions when matching text appears in the MUD output.<br>Text actions are sent to the MUD as commands.<br>JavaScript actions are executed in the browser and can use <code>window.mudApp</code> to interact with the client.</small>",f.style.marginTop="5px",f.style.color="#999",this.editFormContainer.appendChild(f);let m=document.createElement("div");m.className="pattern-test-container";let B=document.createElement("h4");B.textContent="Test Pattern",m.appendChild(B);let b=document.createElement("div");b.className="form-row";let A=document.createElement("label");A.textContent="Test Text:",A.setAttribute("for","pattern-test-input");let u=document.createElement("textarea");u.id="pattern-test-input",u.placeholder="Enter text to test against the pattern",u.rows=4,u.style.width="calc(100% - 110px)",u.style.maxWidth="400px",b.appendChild(A),b.appendChild(u),m.appendChild(b);let L=document.createElement("button");L.className="client-button",L.textContent="Test Pattern",L.addEventListener("click",()=>{let e=s.value,n=a.value,M=u.value;if(!e||!M)return;let I=!1;try{I=this.app.matchTrigger(M,n,e);let i=document.getElementById("pattern-test-result");i||(i=document.createElement("div"),i.id="pattern-test-result",i.className="pattern-test-result",m.appendChild(i)),I?(i.textContent="Match found! The trigger would activate.",i.className="pattern-test-result success"):(i.textContent="No match. The trigger would not activate.",i.className="pattern-test-result failure")}catch(i){let h=document.getElementById("pattern-test-result");h||(h=document.createElement("div"),h.id="pattern-test-result",h.className="pattern-test-result",m.appendChild(h)),h.textContent=`Error: ${i instanceof Error?i.message:"Unknown error"}`,h.className="pattern-test-result failure"}}),m.appendChild(L),this.editFormContainer.appendChild(m);let v=document.createElement("div");v.className="button-row",v.style.marginTop="20px";let w=document.createElement("button");w.className="client-button",w.textContent="Save",w.addEventListener("click",()=>{C===-1?this.app.settings.Triggers.push({match:s.value,type:a.value,actions:o.value,actionType:p.value}):t&&(t.match=s.value,t.type=a.value,t.actions=o.value,t.actionType=p.value),this.app.saveSettings(),this.loadTriggers()});let T=document.createElement("button");T.className="client-button",T.textContent="Cancel",T.style.backgroundColor="#555",T.addEventListener("click",()=>{this.editFormContainer&&(this.editFormContainer.innerHTML="",this.editFormContainer.classList.remove("active"))}),v.appendChild(w),v.appendChild(T),this.editFormContainer.appendChild(v),this.editFormContainer.classList.add("active"),t&&t.actionType==="javascript"&&(o.placeholder="Enter JavaScript code to execute when triggered")}updateUI(){this.loadTriggers()}};export{S as TriggersUI};
//# sourceMappingURL=TriggersUI.js.map
